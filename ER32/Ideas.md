D. 全错排dp。

E. 折半搜索。设两半结果为A和B，枚举A中结果x时，二分B中m-x的上界位置；或者取B中最大值。
