B. 维护stack。

C. 找特殊位置放，竖着的就放第一列最上边，横着的就放最后一行最右边。按照规则，两者永远不会overlap。
