C. dp。

D. dfs(l,r,l',r',k)表示在[l,r]的位置对应[l',r']的数字现在还需要调用k次，然后决定是否要接下去调用。

   
