B. 0->n中的最大power是一定会保留的，那么就[(1<<p)-1,0]然后[1<<p,n]。

C. 

D. 如果一段区间满足gcd(a[l],...,a[r])=r-l+1那么它的子区间和包含它的区间都不可能再是满足的。

   因此如果一个左起点l有一段这样的区间那么右端点r必然唯一。可以二分+rmq查询。
   
   然后得到一些线段排序之后贪心选取最少点cover所有线段。
