C. 二分+dfs。

D. 从高位到低位枚举哪一位i是小于x，然后比i高的位跟x一样，比i低的位全0。然后去贪心划分。
