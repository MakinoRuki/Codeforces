B. 从后往前看以i为起点l的区间的右端点r必须在所有i之后开始的pair的最小结束端点之前。

C. 需要对每个数分解因式，但是并不是根下分解，而是枚举10^5之内的素数，筛法分解。至于超出10^5的素因子，每个数只会有最多1个，所以如果分解之后剩下了那就是大素数。

D. 树上的区间dp。可以先dp出从根到某个叶子的路径上的值(dfs时存下路径到叶子之后暴力求解)，然后dp其余pair的值。
