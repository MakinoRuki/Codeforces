C. 二分。
D. 操作的意义：保留连续的一段[i,j]，把[1,i-1]和[j+1,n]移到两端。因此找出范围不相交的最长的一段。
