C. 二分 + 贪心。

D. 贪心。对于每个人a[i]统计出送给它的下标i，给它随便安排一个i。然后[1,n]在所有a[i]中没出现的和所有i没送出的，先尽量相同值去配对。

   配剩下的随意安排。然后如果配出相同值的是偶数对就两两swap，如果是奇数就剩下3个互相swap或者剩下一个跟已经配好的某个swap。
   
E. 分情况讨论贪心。

   如果有字母只出现一次那就把最小的这样的字母放在第一个位置其它的排序输出；
   
   都出现两次以上看最小的字母先放两个，然后如果它出现次数cnt满足n-cnt>=cnt-2那么就可以剩下的用其他字母隔开；
   
   如果不行，就在开头放最小字母一次和次小字母一次，如果只有2种字母就把次小的全部放完再放最小的；否则就类似abaa...aacb...这样放。
